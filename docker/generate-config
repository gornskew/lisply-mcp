#!/bin/bash

# Generate MCP config with correct absolute paths

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
MCP_EXEC_PATH="$SCRIPT_DIR/mcp-exec"

cat > "$SCRIPT_DIR/mcp-config.json" << EOF
{
    "mcpServers": {
        "gendl": {
            "command": "wsl",
            "args": [
	        "$MCP_EXEC_PATH",    
                "--backend-host", "gendl",
                "--mount", "/projects:/projects",
                "--mount", "/var/run/docker.sock:/var/run/docker.sock",
                "--mount", "/tmp/.X11-unix:/tmp/.X11-unix"
            ]
        },
        "skewed-emacs": {
            "command": "wsl",
            "args": [
	        "$MCP_EXEC_PATH",  
                "--server-name", "skewed-emacs",
                "--http-host-port", "7081",
                "--http-port", "7080",
                "--image-base-name", "gornskew/skewed-emacs",
                "--backend-host", "skewed-emacs",
                "--mount", "/projects:/projects",
                "--mount", "/tmp/.X11-unix:/tmp/.X11-unix",
                "--mount", "/var/run/docker.sock:/var/run/docker.sock"
            ]
        }
    }
}
EOF

echo "Generated MCP config at: $SCRIPT_DIR/mcp-config.json"
echo ""
echo "Copy the contents of this file to your Claude Desktop MCP configuration:"
echo ""
cat "$SCRIPT_DIR/mcp-config.json"
